<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Beer Garden 101</title>
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article">
<div id="header">
<h1>Beer Garden 101</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This course is designed to take a developer who is familiar with Python and
bring them up to speed on how to create and execute a Plugin on Beer Garden.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview-of-beer-garden"><a class="anchor" href="#overview-of-beer-garden"></a>Overview of Beer Garden</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Beer Garden is targeted to help developers break the barrier between python
scripts and software. So much of software development is tangled in the weeds
of standing up services, getting messages from one component to another,
creating UIs, writing documentation, and concurrently supporting multiple
versions. We wanted to change that. Beer Garden makes it as easy as running
the main method.</p>
</div>
<div class="paragraph">
<p>Development of the Beer Garden framework is written in Python for Python. It has been a
multi-year effort to bring Beer Garden to the state it is today. It is constantly
evolving as we learn new and innovative techniques. It also evolves with each new
contributor because everyone brings their own unique skills and passions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-can-it-help"><a class="anchor" href="#how-can-it-help"></a>How can it help?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Beer Garden aims to bridge several gaps. Here are some scenarios where it can be helpful:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">"<em>I can write a script, but I&#8217;m not a developer</em>"</dt>
<dd>
<p>One gap is between people who know how to write scripts and software developers. Beer Garden can take scripts written by anyone and turn them into a service exposed over REST with very little effort.</p>
</dd>
<dt class="hdlist1">"<em>I have a useful script, but I don&#8217;t want to write a GUI</em>"</dt>
<dd>
<p>Beer Garden provides a web-based form that can exercise your script. That way you can make life easy for the people that will actually use the script.</p>
</dd>
<dt class="hdlist1">"<em>I wish I had a standard way to call many different services</em>"</dt>
<dd>
<p>Beer Garden provides a standardized interface for exercising disparate services while allowing the services the flexibility they need to continue to grow in different directions. As you draw abstractions from these services, you can build one interface to rule them all.</p>
</dd>
<dt class="hdlist1">"<em>I have lots of useful scripts and I&#8217;d like to make them discoverable</em>"</dt>
<dd>
<p>Beer Garden exposes all these functions and makes them programatically discoverable for very little cost. It allows you the flexibility to continue making your plugins do whatever small thing you want, but also allows other people to build on top of your plugins making more complex plugins that are dynamic and easy-to-use.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="before-we-start"><a class="anchor" href="#before-we-start"></a>Before we Start</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to build a plugin you&#8217;ll need a functioning Python environment. Setting that up is outside the scope of this tutorial; we recommend <a href="https://github.com/pyenv/pyenv">pyenv</a>. You&#8217;ll also need access to a functioning Beer Garden. Check out the <a href="/docs/startup/installation-guides/">installation instructions</a> for ways to stand up your own Beer Garden.</p>
</div>
<div class="paragraph">
<p>The simplest way to get started is to use the utility package we&#8217;ve created to make plugin building as easy as possible. The package is called <code>brewtils</code> and lives on PyPI. You can find <a href="https://brewtils.readthedocs.io">Brewtils API Documentation here</a>. Add it to your environment like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">pip install brewtils</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="terminology"><a class="anchor" href="#terminology"></a>Terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To really understand Beer Garden, we need to start speaking the same language. Beer Garden has four fundamental building blocks. Quick definitions are given below along with how each would be used if you were to use Beer Garden to define a calculator.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Systems</dt>
<dd>
<p>A group of similar commands, analogous to a class. Something like a calculator.</p>
</dd>
<dt class="hdlist1">Commands</dt>
<dd>
<p>The definition of an action, analogous to functions. The addition operation on a calculator.</p>
</dd>
<dt class="hdlist1">Parameters</dt>
<dd>
<p>Inputs to a command, analogous to function parameters. The numbers to be added together in the addition operation.</p>
</dd>
<dt class="hdlist1">Requests</dt>
<dd>
<p>An actual action that is performed, analogous to calling a function. The act of adding two numbers using the addition operation.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ui-orientation"><a class="anchor" href="#ui-orientation"></a>UI Orientation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you have Beer Garden up and running it is time to explore the UI.</p>
</div>
<div class="sect2">
<h3 id="navigation"><a class="anchor" href="#navigation"></a>Navigation</h3>
<div class="paragraph">
<p>Non-admin users are provided a basic list of areas where they can navigate to.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/navigation-user.png" alt="Navigation User">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Systems</code> - Toggles the drop down to view all systems deployed</p>
</li>
<li>
<p><code>complex</code> - Links to that specific system</p>
</li>
<li>
<p><code>Commands</code> - Link to page with all deployed commands</p>
</li>
<li>
<p><code>Requests</code> - Link to page to view all requests received by Beer Garden</p>
</li>
<li>
<p><code>Scheduler</code> - Link to the scheduler tool for setup automated requests</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="admin-only"><a class="anchor" href="#admin-only"></a>Admin Only</h4>
<div class="paragraph">
<p>Admin users have additional areas where they can navigate to.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/navigation-admin.png" alt="Naviagation Admin">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>System Management</code> - Administrative page to start/stop/rescan/delete connected systems</p>
</li>
<li>
<p><code>Queue Management</code> - Administrative page to manage the queues that systems are listening to</p>
</li>
<li>
<p><code>User Management</code> - Administrative page to manage user permissions</p>
</li>
<li>
<p><code>Role Management</code> - Administrative page to create new roles</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="systems"><a class="anchor" href="#systems"></a>Systems</h3>
<div class="paragraph">
<p>As a developer you have the ability to provide information that will be present to
the user.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex_system.png" alt="Complex System">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Label of the system (Developer Provided)</p>
</li>
<li>
<p>Version of system (Developer Provided)</p>
</li>
<li>
<p>Brief description of the system (Developer Provided)</p>
</li>
<li>
<p>Total number of commands contained within system</p>
</li>
<li>
<p>Total number of instances of this system/version that are running</p>
</li>
<li>
<p>Link the commands page for this system</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="commands"><a class="anchor" href="#commands"></a>Commands</h3>
<div class="paragraph">
<p>The base page is the same for both system specific commands and the global command page
(commands on navigation panel). This page will display all of the available commands that
can be requested.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex_commands.png" alt="Complex Commands Page">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Label of the command (If not provided by developer it is the function name)</p>
</li>
<li>
<p>Description of command (Developer Provided)</p>
</li>
<li>
<p>Global search of all commands in the table</p>
</li>
<li>
<p>Invokes the command to generate a request</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="request"><a class="anchor" href="#request"></a>Request</h3>
<div class="paragraph">
<p>When you want to invoke a command it is done through that commands request page. Once submitted,
it will be executed by Beer Garden</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex_command_request.png" alt="Complex Command Request">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The form displayed is generated from the annotations a developer added to the command function</p>
</li>
<li>
<p>Comments added have no impact to the execution of the command. The comment will persist with
the request and can be viewed.</p>
</li>
<li>
<p>This will clear any input entered into the form</p>
</li>
<li>
<p>Executes the request. Once this is clicked the user will be transferred to the request View page</p>
</li>
<li>
<p>If there are multiple instances of the system/version running, the user can select which should
execute the request.</p>
</li>
<li>
<p>This is a preview of the request object. If you select the gear next to <code>Preview</code> the user can
manually change the values here.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="request-view"><a class="anchor" href="#request-view"></a>Request View</h3>
<div class="paragraph">
<p>After a Request has been submitted to Beer Garden the user is redirected to the Viewer page for
that request. Here the user can get operational updates on the request.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/request-view.png" alt="Request View Example">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The unique identifier associated with the request. This can also be seen in the URL</p>
</li>
<li>
<p>The original request that was submitted</p>
</li>
<li>
<p>Links to any child requests that were generated</p>
</li>
<li>
<p>The output of the request. This can be HTML, JSON, or String</p>
</li>
<li>
<p>Current status of the request</p>
</li>
<li>
<p>The original input parameters for the request. (Helpful for debugging child requests)</p>
</li>
<li>
<p>Timestamp when the request object was last updated</p>
</li>
<li>
<p>Selecting this will bring the user back to the request page with the request parameters pre-populated</p>
</li>
<li>
<p>Any comments that were added during the request creation</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="scheduler"><a class="anchor" href="#scheduler"></a>Scheduler</h3>
<div class="paragraph">
<p>The scheduler tool is a multi-page selection process. The user selects the system and command that
should be scheduled for a future or re-occurring job. After the user creates the template request to
be submitted the user must add the job trigger information.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/scheduler-job.png" alt="Scheduler Job Example">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Job name that will be displayed</p>
</li>
<li>
<p>Type of trigger that will be utilized. When selected, that tab must be populated.</p>
</li>
<li>
<p>If coalescing is enabled for the job and the scheduler sees one or more queued executions
for the job, it will only trigger it once.</p>
</li>
<li>
<p>Time in seconds that the job is allowed to miss the designated run time before being considered to have misfired</p>
</li>
<li>
<p>Maximum number of concurrently running instances allowed for this job</p>
</li>
<li>
<p>Repeats job with CRON formatting</p>
</li>
<li>
<p>Repeats job on a set time internal within a provided date range (if provided)</p>
</li>
<li>
<p>Runs the job once at a future timestamp</p>
</li>
<li>
<p>Runs the job whenever a file operation occurs and matches the given pattern.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Note:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Patterns are matched with the directory prepended, so adjust accordingly
(e.g. <code>hello.txt</code> &#8594; <code>*/hello.txt</code>)</p>
</li>
<li>
<p>Callback events may not match expected behavior depending on operating system/application-specific
implementations.  Some programs are known to cause both <code>delete</code> and <code>create</code> events when a <code>modify</code>
event is expected.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Clears the form</p>
</li>
<li>
<p>Creates the job to be triggered at the registered time</p>
</li>
<li>
<p>Preview of the job being created</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-plugins-for-beer-garden"><a class="anchor" href="#writing-plugins-for-beer-garden"></a>Writing Plugins for Beer Garden</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After completing this section you will have created a Beer Garden plugin that can be
deployed against an active Beer Garden instance.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example-1-hello-beer-garden"><a class="anchor" href="#example-1-hello-beer-garden"></a>Example 1: Hello Beer Garden</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section will walk you through creating a simple Hello, World example.</p>
</div>
<div class="sect2">
<h3 id="write-the-code"><a class="anchor" href="#write-the-code"></a>Write the code</h3>
<div class="paragraph">
<p>Plugins are basically just classes that you would like to expose over the network. So let&#8217;s create a simple, and classic "Hello, World!" example.
Use your favorite text editor and open up a file called <code>plugin.py</code> and write your basic Hello World example:</p>
</div>
<div class="listingblock">
<div class="title">plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">def</span> <span class="function">main</span>():
        print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, World!</span><span class="delimiter">&quot;</span></span>)

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
        main()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To further structure the code, we can evolve the plugin.py to utilize class objects:</p>
</div>
<div class="listingblock">
<div class="title">plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">class</span> <span class="class">HelloWorldClient</span>:

    <span class="keyword">def</span> <span class="function">hello_world</span>(<span class="predefined-constant">self</span>):
        greeting = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, World!</span><span class="delimiter">&quot;</span></span>

        print(greeting)

<span class="keyword">def</span> <span class="function">main</span>():
        client = HelloWorldClient()
        client.hello_world()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
        main()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to integrate Beer Garden Annotations into your class object.</p>
</div>
<div class="listingblock">
<div class="title">plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">command</span>, <span class="include">system</span>

<span class="decorator">@system</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="keyword">class</span> <span class="class">HelloWorldClient</span>(<span class="predefined">object</span>):

    <span class="decorator">@command</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="keyword">def</span> <span class="function">hello_world</span>(<span class="predefined-constant">self</span>):
        greeting = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, World!</span><span class="delimiter">&quot;</span></span>

        print(greeting)

        <span class="keyword">return</span> greeting</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@system</code> decorator marks this class as a Beer Garden plugin.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@command</code> decorator marks this method as a Command that&#8217;s part of the enclosing System.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once we have the client, we now need to create our entry point.</p>
</div>
<div class="listingblock">
<div class="title">plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">command</span>, <span class="include">system</span>, <span class="include">Plugin</span>


<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">HelloWorldClient</span>(<span class="predefined">object</span>):

    <span class="decorator">@command</span>
    <span class="keyword">def</span> <span class="function">hello_world</span>(<span class="predefined-constant">self</span>):
        greeting = <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, World!</span><span class="delimiter">&quot;</span></span>

        print(greeting)

        <span class="keyword">return</span> greeting


<span class="keyword">def</span> <span class="function">main</span>():
    client = HelloWorldClient() <i class="conum" data-value="1"></i><b>(1)</b>

    plugin = Plugin(
        client, <i class="conum" data-value="2"></i><b>(2)</b>
        name=<span class="string"><span class="delimiter">'</span><span class="content">hello-world</span><span class="delimiter">'</span></span>, <i class="conum" data-value="3"></i><b>(3)</b>
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0</span><span class="delimiter">'</span></span>, <i class="conum" data-value="4"></i><b>(4)</b>
        description=<span class="string"><span class="delimiter">'</span><span class="content">My First Plugin</span><span class="delimiter">'</span></span>, <i class="conum" data-value="5"></i><b>(5)</b>
        bg_host=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="6"></i><b>(6)</b>
        bg_port=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;PORT&gt;</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="7"></i><b>(7)</b>
        ssl_enabled=&lt;SSL_ENABLED&gt;, <i class="conum" data-value="8"></i><b>(8)</b>
    )

    plugin.run() * <i class="conum" data-value="8"></i><b>(8)</b>


<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
    main()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Initializes the HelloWorldClient</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Passes the HelloWorldClient as the target Client class for the Plugin Library</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name utilized when referencing the plugin for routing and display</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The version utilized when reference the plugin for routing and display</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The description displayed when viewing the plugin in the UI</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The hostname or IP of the target Beer Garden instance</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The port that Beer Garden is listening on (Default is 2337)</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>If SSL is enabled, if TRUE then additional fields are required.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To review what&#8217;s happening here: we added an import <code>Plugin</code> at the top of our file and created a standard main method. In that method we created a <code>HelloWorldClient</code> object and a <code>Plugin</code> object. Notice that when we create the <code>Plugin</code> we pass it the client and some additional parameters.</p>
</div>
<div class="paragraph">
<p>That&#8217;s all the code you need!</p>
</div>
</div>
<div class="sect2">
<h3 id="run-the-code"><a class="anchor" href="#run-the-code"></a>Run the code</h3>
<div class="paragraph">
<p>Run the plugin like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python plugin.py</pre>
</div>
</div>
<div class="paragraph">
<p>It will start up and print some logging showing the plugin registering with Beer Garden. Congratulations! You&#8217;ve just deployed your first plugin!</p>
</div>
</div>
<div class="sect2">
<h3 id="use-the-code"><a class="anchor" href="#use-the-code"></a>Use the code</h3>
<div class="paragraph">
<p>At this point you should see your plugin on the <code>Available Systems</code> page in <code>Brew View</code>. Click the big blue <code>Explore hello_world commands</code> button to see a list of all commands available for the Plugin you made.</p>
</div>
<div class="paragraph">
<p>As part of this tutorial the only command listed should be the <code>say_hello</code> command because we only defined one command. Click the <code>Make it Happen!</code> button to go to the page for that command.</p>
</div>
<div class="paragraph">
<p>The command page is where you can specify options and customization for individual executions of that command. Since we didn&#8217;t define any options (this command always prints 'Hello World!') the only customization available is the comment field. You can add free-form text here and it will be included as part of the request you&#8217;re generating.</p>
</div>
<div class="paragraph">
<p>Are you ready? Click the <code>Make Request</code> button when you&#8217;re ready.</p>
</div>
<div class="paragraph">
<p>Making a request takes you to the Request page for the request you just generated. You can see the unique ID as part of the page title. You should see the status start as <code>IN PROGRESS</code> and then change to <code>SUCCESS</code> once the request completes. Also notice that the output changes when the request is finished.</p>
</div>
<div class="paragraph">
<p>If you didn&#8217;t catch those changes on the first try, don&#8217;t worry. Use the <code>Pour it Again</code> button in the top-right corner to go back to the command screen you just left. From there you can use the <code>Make Request</code> button to make another request.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This command doesn&#8217;t have any parameters, but for commands that do the <code>Pour it Again</code> button will default them to exactly how they were for the original request.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="stop-the-code"><a class="anchor" href="#stop-the-code"></a>Stop the code</h3>
<div class="paragraph">
<p>The best way to stop a plugin is to use the 'Systems Management' page to send a stop message. In <code>Brew View</code> find the <code>Systems Management</code> option under the <code>Administration</code> menu. Then click the stop icon next to the <code>hello-world</code> listing.</p>
</div>
<div class="paragraph">
<p>You should see your plugin log that it has terminated and stop executing, and if you go to the main page in <code>Brew View</code> you should see the <code>hello-world</code> plugin is 'STOPPED'.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can also use Ctrl-c to stop the plugin from the terminal. This works, but it doesn&#8217;t tell Beer Garden that the plugin is stopping. You&#8217;ll still see the plugin terminate and stop executing, but the status in <code>Brew View</code> will still be 'RUNNING'. After a short period the status will change to 'UNRESPONSIVE'.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example-2-running-shell-commands"><a class="anchor" href="#example-2-running-shell-commands"></a>Example 2: Running Shell Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For this example, we are going to explore kicking off Shell Commands from Beer Garden plugins. To accomplish
this we have to select a Shell Command that best fits your environment. For this example we will use nslookup
because it is available on most operating systems (Mac OS, Ubuntu, Windows, Centos).</p>
</div>
<div class="sect2">
<h3 id="execute-locally"><a class="anchor" href="#execute-locally"></a>Execute Locally</h3>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">nslookup python.org</code></pre>
</div>
</div>
<div class="paragraph">
<p>Go ahead and run this in the command line to ensure that it works properly in your environment.
You should get something like the following</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">Server:     &lt;DNS Server&gt;
Address:    &lt;DNS Server Address&gt;

Non-authoritative answer:
Name:    python.org
Address: 45.55.99.72</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-base-class"><a class="anchor" href="#create-base-class"></a>Create Base Class</h3>
<div class="paragraph">
<p>Like the first example, lets build this out into a basic Python class.  For this example, we will provide
the raw output but feel free to get creative with parsing the output.</p>
</div>
<div class="listingblock">
<div class="title">nslookup_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">subprocess</span>

<span class="keyword">class</span> <span class="class">NSLookupClient</span>:

    <span class="keyword">def</span> <span class="function">request_nslookup</span>(<span class="predefined-constant">self</span>, domain):
        process = subprocess.Popen([<span class="string"><span class="delimiter">'</span><span class="content">nslookup</span><span class="delimiter">'</span></span>, domain],
                     stdout=subprocess.PIPE)

        print(process.stdout.readlines())

<span class="keyword">def</span> <span class="function">main</span>():
        client = NSLookupClient()
        client.request_nslookup(<span class="string"><span class="delimiter">&quot;</span><span class="content">python.org</span><span class="delimiter">&quot;</span></span>)

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
        main()</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="convert-to-beer-garden-plugin"><a class="anchor" href="#convert-to-beer-garden-plugin"></a>Convert to Beer Garden Plugin</h3>
<div class="paragraph">
<p>Instead of creating a new class, let convert the function directly into a Beer Garden system command.
That way we can expose this function in the UI.</p>
</div>
<div class="listingblock">
<div class="title">nslookup_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">command</span>, <span class="include">system</span>, <span class="include">parameter</span>, <span class="include">Plugin</span>
<span class="keyword">import</span> <span class="include">subprocess</span>

<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">NSLookupClient</span>:

    <span class="decorator">@command</span>
    <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">domain</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="2"></i><b>(2)</b>
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="3"></i><b>(3)</b>
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">The domain to be looked up via NSLookup</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="4"></i><b>(4)</b>
        default=<span class="string"><span class="delimiter">&quot;</span><span class="content">python.org</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="5"></i><b>(5)</b>
    )
    <span class="keyword">def</span> <span class="function">request_nslookup</span>(<span class="predefined-constant">self</span>, domain):
        process = subprocess.Popen([<span class="string"><span class="delimiter">'</span><span class="content">nslookup</span><span class="delimiter">'</span></span>, domain],
                     stdout=subprocess.PIPE)
        <span class="keyword">return</span> process.stdout.readlines()

<span class="keyword">def</span> <span class="function">main</span>():
        client = NSLookupClient()

        plugin = Plugin(
        client,
        name=<span class="string"><span class="delimiter">'</span><span class="content">nslookup</span><span class="delimiter">'</span></span>,
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0</span><span class="delimiter">'</span></span>,
        description=<span class="string"><span class="delimiter">'</span><span class="content">Runs Shell Command NSLookup</span><span class="delimiter">'</span></span>,
        bg_host=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>,
        bg_port=&lt;PORT&gt;,
        ssl_enabled=&lt;SSL_ENABLED&gt;,
    )

    plugin.run()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
        main()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@parameter</code> decorator identifies that the command has input parameters</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>key</code> field marks the input variable to map to</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the <code>type</code> field marks the valid input type</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>description</code> field marks what will be displayed on the UI under the parameter</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <code>default</code> field will pre-populate the UI as the default input parameter</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We will go over more complex forms in Example 5 to review the various input types.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s run the code and check it out on the Beer Garden UI.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python nslookup_plugin.py</pre>
</div>
</div>
<div class="paragraph">
<p>We can see that a field is now populated on the <code>Request Page</code> for the command and that <code>python.org</code> is
pre-populated in the form. When you click <code>Make Request</code> you should get a similar result to the following.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/nslookup-request.png" alt="NSlookup Request">
</div>
</div>
<div class="paragraph">
<p>We can see the raw response from the command we executed in the <code>Output</code> field.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/nslookup-response.png" alt="NSlookup Response">
</div>
</div>
</div>
<div class="sect2">
<h3 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h3>
<div class="paragraph">
<p>This has been a basic example of how you can use Beer Garden to run Shell Script commands. You can
expand on this exampled to run bash files or any other command you have access to in your terminal.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example-3-web-scraping"><a class="anchor" href="#example-3-web-scraping"></a>Example 3: Web Scraping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For this example we are going to explore Web Scraping. There are many different ways to accomplish
this task in Python. For our examples we are going to use two additional libraries,
<a href="https://requests.readthedocs.io/en/master/">Requests</a> and
<a href="https://www.crummy.com/software/BeautifulSoup/">BeautifulSoup</a>.</p>
</div>
<div class="paragraph">
<p>Before we start, please ensure these libraries are installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">pip install beautifulsoup4 requests</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="write-base-class"><a class="anchor" href="#write-base-class"></a>Write Base Class</h3>
<div class="paragraph">
<p>We are going to utilize the Beer-Garden.io website as our source. So like before, let&#8217;s build up a base
class object that can interact with the Beer-Garden.io website to pull some attributes. For our example, we
will be scraping the Preamble section of the Beer Garden homepage.</p>
</div>
<div class="listingblock">
<div class="title">web_scraping_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">requests</span>
<span class="keyword">from</span> <span class="include">bs4</span> <span class="keyword">import</span> <span class="include">BeautifulSoup</span>


<span class="keyword">class</span> <span class="class">WebScrapingClient</span>:

    <span class="keyword">def</span> <span class="function">download_url</span>(<span class="predefined-constant">self</span>, url):
        page = requests.get(url)
        soup = BeautifulSoup(page.content, <span class="string"><span class="delimiter">'</span><span class="content">html.parser</span><span class="delimiter">'</span></span>)
        <span class="keyword">return</span> soup

    <span class="keyword">def</span> <span class="function">extract_id</span>(<span class="predefined-constant">self</span>, url, <span class="predefined">id</span>):
        soup = <span class="predefined-constant">self</span>.download_url(url)
        <span class="keyword">return</span> soup.find(id=<span class="predefined">id</span>).prettify()


<span class="keyword">def</span> <span class="function">main</span>():
    client = WebScrapingClient()
    preamble = client.extract_id(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://www.beer-garden.io</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">preamble</span><span class="delimiter">&quot;</span></span>)
    print(preamble)

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
        main()</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="convert-to-beer-garden-plugin-2"><a class="anchor" href="#convert-to-beer-garden-plugin-2"></a>Convert to Beer Garden Plugin</h3>
<div class="paragraph">
<p>Just like the previous examples, we now want to convert this Class into a Beer Garden Plugin, but this
time we want to return the output as an HTML object.</p>
</div>
<div class="listingblock">
<div class="title">web_scraping_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">requests</span>
<span class="keyword">from</span> <span class="include">bs4</span> <span class="keyword">import</span> <span class="include">BeautifulSoup</span>
<span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">command</span>, <span class="include">system</span>, <span class="include">parameter</span>, <span class="include">Plugin</span>

<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">WebScrapingClient</span>:

    <span class="keyword">def</span> <span class="function">download_url</span>(<span class="predefined-constant">self</span>, url):
        page = requests.get(url)
        soup = BeautifulSoup(page.content, <span class="string"><span class="delimiter">'</span><span class="content">html.parser</span><span class="delimiter">'</span></span>)
        <span class="keyword">return</span> soup

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTML</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">The URL to be looked up via Web Scraper</span><span class="delimiter">&quot;</span></span>,
        default=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://www.beer-garden.io</span><span class="delimiter">&quot;</span></span>,
    )
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">The element ID to be extracted</span><span class="delimiter">&quot;</span></span>,
        default=<span class="string"><span class="delimiter">&quot;</span><span class="content">preamble</span><span class="delimiter">&quot;</span></span>,
    )
    <span class="keyword">def</span> <span class="function">extract_id</span>(<span class="predefined-constant">self</span>, url, <span class="predefined">id</span>):
        soup = <span class="predefined-constant">self</span>.download_url(url)
        <span class="keyword">return</span> soup.find(id=<span class="predefined">id</span>).prettify()


<span class="keyword">def</span> <span class="function">main</span>():
    client = WebScrapingClient()

    plugin = Plugin(
        client,
        name=<span class="string"><span class="delimiter">'</span><span class="content">WebScraper</span><span class="delimiter">'</span></span>,
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0</span><span class="delimiter">'</span></span>,
        description=<span class="string"><span class="delimiter">'</span><span class="content">Scrapes requested website with BS4</span><span class="delimiter">'</span></span>,
        bg_host=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>,
        bg_port=&lt;PORT&gt;,
        ssl_enabled=&lt;SSL_ENABLED&gt;,
    )

    plugin.run()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
        main()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>output_type</code> field can be set to HTML, JSON, or STRING. This field alters how the UI renders
the Output Cell</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now that everything is ready, let&#8217;s run this and invoke the command in the UI.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python web_scraping_plugin.py</pre>
</div>
</div>
<div class="paragraph">
<p>Since we changed the output type to HTML, the UI provides two options for viewing the output cell</p>
</div>
</div>
<div class="sect2">
<h3 id="formatted"><a class="anchor" href="#formatted"></a>Formatted</h3>
<div class="paragraph">
<p>Beer Garden UI renders the HTML from the output cell if it is valid HTML.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/webscraper-response-formatted.png" alt="Web Scraper Formatted Results">
</div>
</div>
</div>
<div class="sect2">
<h3 id="raw"><a class="anchor" href="#raw"></a>Raw</h3>
<div class="paragraph">
<p>If the user wants to see the raw format of the results, they just have to toggle the <code>Formatted</code>
option to <code>Raw</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/webscraper-response-raw.png" alt="Web Scraper Raw Results">
</div>
</div>
</div>
<div class="sect2">
<h3 id="conclusion-2"><a class="anchor" href="#conclusion-2"></a>Conclusion</h3>
<div class="paragraph">
<p>This was a basic example of how you can use Beer Garden to scrape data from web pages. You might
expand upon this example to perform daily dumps of data sets that are only published via static HTML pages.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example-4-connecting-to-external-data-sets"><a class="anchor" href="#example-4-connecting-to-external-data-sets"></a>Example 4: Connecting to External Data sets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For this example we are going to explore connecting to external API&#8217;s. There are many different ways to accomplish
this task in Python. For our examples we are going to use two additional libraries,
<a href="https://requests.readthedocs.io/en/master/">Requests</a> and
<a href="https://xlrd.readthedocs.io/en/latest/">xlrd</a></p>
</div>
<div class="paragraph">
<p>Before we start, please ensure these libraries are installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">pip install requests
pip install xlrd</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are many public data sets available for developers to interact with. One amazing resource is
<a href="https://catalog.data.gov/dataset">Data.gov</a>. There is a wide range of data provided by Federal and
State governments. For this example, we will use the
<a href="https://www.ttb.gov/beer/statistics">Beer Statistics</a> data set. To accomplish this we must download the XLS
file and then parse it to JSON.</p>
</div>
<div class="paragraph">
<p>To ensure this guide has continuity, we will be looking at the Number of Brewers by Production Size. This
data set currently has years 2008-2019 available. The Aggregate Data is an interesting dataset, but is
subject to change once the 2020 data set is released.</p>
</div>
<div class="paragraph">
<p>Before we can start, we first must understand how to reference each year. This is the basic breakdown
of the download link</p>
</div>
<div class="literalblock">
<div class="content">
<pre>https://www.ttb.gov/images/pdfs/statistics/production_size/&lt;YEAR&gt;_brew_prod_size_ttb_gov.xlsx</pre>
</div>
</div>
<div class="paragraph">
<p>If this link does not work, we have a backup.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>../docs/training/datasets/&lt;YEAR&gt;_brew_prod_size_ttb_gov.xlsx</pre>
</div>
</div>
<div class="paragraph">
<p>A couple things to know before parsing the data. The start line of the statistics does change
but they keep that same naming convention. So we know that the statistics always starts two lines after
<code>Production Size - CY &lt;YEAR&gt;</code> and ends one line before <code>Total</code>. So we can use that to our benefit when parsing the Excel
file. Let&#8217;s go ahead and build a basic parser for these statistics.</p>
</div>
<div class="listingblock">
<div class="title">beer_statistics_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">xlrd</span>
<span class="keyword">import</span> <span class="include">requests</span>


<span class="keyword">class</span> <span class="class">BeerStatisticsClient</span>:

    <span class="keyword">def</span> <span class="function">download_raw_stats</span>(<span class="predefined-constant">self</span>, year):
        year_statistics_file = requests.get(
            <span class="string"><span class="delimiter">'</span><span class="content">https://www.ttb.gov/images/pdfs/statistics/production_size/%s_brew_prod_size_ttb_gov.xlsx</span><span class="delimiter">'</span></span> % year)
        year_statistics_book = xlrd.open_workbook(file_contents=year_statistics_file.content)
        <span class="keyword">return</span> year_statistics_book.sheet_by_index(<span class="integer">0</span>)

    <span class="keyword">def</span> <span class="function">parse_sheet</span>(<span class="predefined-constant">self</span>, sheet):
        start_line = <span class="integer">0</span>
        end_line = <span class="integer">0</span>

        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="predefined">range</span>(<span class="integer">0</span>, sheet.nrows):
            <span class="keyword">if</span> <span class="predefined">str</span>(sheet.row(x)[<span class="integer">0</span>].value).startswith(<span class="string"><span class="delimiter">&quot;</span><span class="content">Production Size - CY</span><span class="delimiter">&quot;</span></span>):
                start_line = x + <span class="integer">2</span>
            <span class="keyword">elif</span> <span class="predefined">str</span>(sheet.row(x)[<span class="integer">0</span>].value) == <span class="string"><span class="delimiter">&quot;</span><span class="content">Total</span><span class="delimiter">&quot;</span></span>:
                end_line = x
                <span class="keyword">break</span>

        raw_statistics = <span class="predefined">list</span>()

        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="predefined">range</span>(start_line, end_line):
            row = sheet.row(x)
            data = <span class="predefined">dict</span>()
            data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Barrels (31 Gallons)</span><span class="delimiter">&quot;</span></span>] = row[<span class="integer">0</span>].value

            <span class="comment"># This is additional formatting to ensure all of the data looks good</span>
            <span class="comment"># Ctype 0 = empty, if it is empty lets just return zero</span>

            <span class="keyword">if</span> row[<span class="integer">1</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Number Of Breweries</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">1</span>].value, <span class="integer">0</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Number Of Breweries</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            <span class="keyword">if</span> row[<span class="integer">2</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Barrels</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">2</span>].value, <span class="integer">2</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Barrels</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            <span class="keyword">if</span> row[<span class="integer">3</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Taxable Removals</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">3</span>].value, <span class="integer">2</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Taxable Removals</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            <span class="keyword">if</span> row[<span class="integer">4</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Shipped (Exported)</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">4</span>].value, <span class="integer">2</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Shipped (Exported)</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            raw_statistics.append(data)

        <span class="keyword">return</span> raw_statistics

    <span class="keyword">def</span> <span class="function">download_year_statistics</span>(<span class="predefined-constant">self</span>, year):

        sheet = <span class="predefined-constant">self</span>.download_raw_stats(year)
        data = <span class="predefined-constant">self</span>.parse_sheet(sheet)
        <span class="keyword">return</span> data


<span class="keyword">def</span> <span class="function">main</span>():
    client = BeerStatisticsClient()
    stats = client.download_year_statistics(<span class="integer">2019</span>)
    print(stats)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that the hard work is done, let&#8217;s see how we can convert this into a Beer Garden Plugin. We only want
to accept years within the current Year range (2008-2019). We also want to return this back as a JSON
object.</p>
</div>
<div class="listingblock">
<div class="title">beer_statistics_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">xlrd</span>
<span class="keyword">import</span> <span class="include">requests</span>
<span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">command</span>, <span class="include">system</span>, <span class="include">parameter</span>, <span class="include">Plugin</span>

<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">BeerStatisticsClient</span>:

    <span class="keyword">def</span> <span class="function">download_raw_stats</span>(<span class="predefined-constant">self</span>, year):
        year_statistics_file = requests.get(
            <span class="string"><span class="delimiter">'</span><span class="content">https://www.ttb.gov/images/pdfs/statistics/production_size/%s_brew_prod_size_ttb_gov.xlsx</span><span class="delimiter">'</span></span> % year)
        year_statistics_book = xlrd.open_workbook(file_contents=year_statistics_file.content)
        <span class="keyword">return</span> year_statistics_book.sheet_by_index(<span class="integer">0</span>)

    <span class="keyword">def</span> <span class="function">parse_sheet</span>(<span class="predefined-constant">self</span>, sheet):
        start_line = <span class="integer">0</span>
        end_line = <span class="integer">0</span>

        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="predefined">range</span>(<span class="integer">0</span>, sheet.nrows):
            <span class="keyword">if</span> <span class="predefined">str</span>(sheet.row(x)[<span class="integer">0</span>].value).startswith(<span class="string"><span class="delimiter">&quot;</span><span class="content">Production Size - CY</span><span class="delimiter">&quot;</span></span>):
                start_line = x + <span class="integer">2</span>
            <span class="keyword">elif</span> <span class="predefined">str</span>(sheet.row(x)[<span class="integer">0</span>].value) == <span class="string"><span class="delimiter">&quot;</span><span class="content">Total</span><span class="delimiter">&quot;</span></span>:
                end_line = x
                <span class="keyword">break</span>

        raw_statistics = <span class="predefined">list</span>()

        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="predefined">range</span>(start_line, end_line):
            row = sheet.row(x)
            data = <span class="predefined">dict</span>()
            data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Barrels (31 Gallons)</span><span class="delimiter">&quot;</span></span>] = row[<span class="integer">0</span>].value

            <span class="comment"># This is additional formatting to ensure all of the data looks good</span>
            <span class="comment"># Ctype 0 = empty</span>

            <span class="keyword">if</span> row[<span class="integer">1</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Number Of Breweries</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">1</span>].value, <span class="integer">0</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Number Of Breweries</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            <span class="keyword">if</span> row[<span class="integer">2</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Barrels</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">2</span>].value, <span class="integer">2</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Barrels</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            <span class="keyword">if</span> row[<span class="integer">3</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Taxable Removals</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">3</span>].value, <span class="integer">2</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Taxable Removals</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            <span class="keyword">if</span> row[<span class="integer">4</span>].ctype == <span class="integer">2</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Shipped (Exported)</span><span class="delimiter">&quot;</span></span>] = <span class="predefined">round</span>(row[<span class="integer">4</span>].value, <span class="integer">2</span>)
            <span class="keyword">else</span>:
                data[<span class="string"><span class="delimiter">&quot;</span><span class="content">Total Shipped (Exported)</span><span class="delimiter">&quot;</span></span>] = <span class="integer">0</span>

            raw_statistics.append(data)

        <span class="keyword">return</span> raw_statistics

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">Integer</span><span class="delimiter">&quot;</span></span>, <i class="conum" data-value="2"></i><b>(2)</b>
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Select the year to pull Beer Production Statistics</span><span class="delimiter">&quot;</span></span>,
        choices=<span class="predefined">list</span>(<span class="predefined">range</span>(<span class="integer">2008</span>, <span class="integer">2019</span>)), <i class="conum" data-value="3"></i><b>(3)</b>
    )
    <span class="keyword">def</span> <span class="function">download_year_statistics</span>(<span class="predefined-constant">self</span>, year):

        sheet = <span class="predefined-constant">self</span>.download_raw_stats(year)
        data = <span class="predefined-constant">self</span>.parse_sheet(sheet)
        <span class="keyword">return</span> data


<span class="keyword">def</span> <span class="function">main</span>():
    client = BeerStatisticsClient()

    plugin = Plugin(
        client,
        name=<span class="string"><span class="delimiter">'</span><span class="content">BeerStatistics</span><span class="delimiter">'</span></span>,
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0</span><span class="delimiter">'</span></span>,
        description=<span class="string"><span class="delimiter">'</span><span class="content">Parses data from TTB.gov on Brewer Production sizes of Beer</span><span class="delimiter">'</span></span>,
        bg_host=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>,
        bg_port=&lt;PORT&gt;,
        ssl_enabled=<span class="predefined-constant">False</span>,
    )

    plugin.run()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
    main()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>output_type</code> field can be set to HTML, JSON, or STRING. These will alter how the UI renders
the Output Cell</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>type</code> field limits valid input types to <code>Integer</code> types</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>choices</code> field allows a developer to provide a list of valid input values</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now that everything is ready, let&#8217;s run this and invoke the command in the UI.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python beer_statistics_plugin.py</pre>
</div>
</div>
<div class="sect2">
<h3 id="request-form"><a class="anchor" href="#request-form"></a>Request Form</h3>
<div class="paragraph">
<p>We can see in the request that we no longer have a free form text field, but a dropdown option with the
year ranges 2008 to 2019.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/beer-statistics-request.png" alt="Beer Statistics Request">
</div>
</div>
</div>
<div class="sect2">
<h3 id="request-response"><a class="anchor" href="#request-response"></a>Request Response</h3>
<div class="paragraph">
<p>In the Output cell the data is parsed in JSON format for easy viewing. Just like the HTML output, this can
be converted to RAW output.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/beer-statistics-response.png" alt="Beer Statistics Request">
</div>
</div>
</div>
<div class="sect2">
<h3 id="conclusion-3"><a class="anchor" href="#conclusion-3"></a>Conclusion</h3>
<div class="paragraph">
<p>This has been a basic example of how you can use Beer Garden to pull a data set and display it to your user.
We challenge you to try extracting the other data sets on Beer Production, or another dataset
available through <a href="https://catalog.data.gov/dataset">Data.gov</a>, or your own data sets.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example-5-user-forms-and-advanced-features"><a class="anchor" href="#example-5-user-forms-and-advanced-features"></a>Example 5: User Forms and Advanced Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have covered the basics of how to create Beer Garden Plugins with a variety of input and output types.
This example will merge these concepts together while creating more complex user forms.</p>
</div>
<div class="paragraph">
<p>For this example you will need the Beer Statistics Plugin running from the last example.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python beer_statistics_plugin.py</pre>
</div>
</div>
<div class="paragraph">
<p>We are going to create a new plugin that accomplishes the following tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Connect to the Beer Statistics Plugin and spawn a child request</p>
</li>
<li>
<p>Dynamically creates a Drop Down for Year Range</p>
</li>
<li>
<p>Dynamically creates a Drop Down for Field Summary Option</p>
</li>
<li>
<p>Creates a request that finds the Sum Total for one field from the Beer Statistics Plugin</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We are going to work down this list in order for creating our new plugin.</p>
</div>
<div class="sect2">
<h3 id="connect-to-another-client"><a class="anchor" href="#connect-to-another-client"></a>Connect to Another Client</h3>
<div class="paragraph">
<p>In this snippet we are going to create a <code>System Client</code> connection with to allow access
to remote commands within the Beer Statistics Plugin.</p>
</div>
<div class="listingblock">
<div class="title">complex_beer_statistics_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">parameter</span>, <span class="include">command</span>, <span class="include">system</span>, <span class="include">SystemClient</span>, <span class="include">Plugin</span>
<span class="keyword">import</span> <span class="include">json</span>

<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">ComplexBeerStatisticsClient</span>:

    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="predefined-constant">self</span>, params):
        <span class="comment"># (1)</span>
        <span class="predefined-constant">self</span>.beer_statistics_client = SystemClient(system_name=<span class="string"><span class="delimiter">&quot;</span><span class="content">BeerStatistics</span><span class="delimiter">&quot;</span></span>, **params)

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client</span>(<span class="predefined-constant">self</span>):
        <span class="comment"># (2)</span>
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=<span class="integer">2010</span>)
        <span class="comment"># (3)</span>
        <span class="keyword">return</span> results.output

<span class="keyword">def</span> <span class="function">main</span>():

    <span class="comment"># (4)</span>
    connection_params = {<span class="string"><span class="delimiter">&quot;</span><span class="content">bg_host</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">bg_port</span><span class="delimiter">&quot;</span></span>:&lt;PORT&gt;,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">ssl_enabled</span><span class="delimiter">&quot;</span></span>:<span class="predefined-constant">False</span>}

    client = ComplexBeerStatisticsClient(connection_params)

    plugin = Plugin(
        client,
        name=<span class="string"><span class="delimiter">'</span><span class="content">ComplexBeerStatistics</span><span class="delimiter">'</span></span>,
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0.dev</span><span class="delimiter">'</span></span>, <span class="comment"># (5)</span>
        description=<span class="string"><span class="delimiter">'</span><span class="content">Parses data from TTB.gov on Brewer Production sizes of Beer</span><span class="delimiter">'</span></span>,
        **connection_params
    )

    plugin.run()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
    main()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Developers can reference other clients through the <code>SystemClient</code> class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>All commands on <code>SystemClient</code> can be referenced directly like a standard Class Function</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The output of the <code>Command</code> is a <code>Request</code>. Developers can put the raw output from the <code>output</code> field.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>For ease of use, we are passing forward connection parameters so we only have to define it once</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Because we are going to start and stop this plugin multiple times, using the <code>.dev</code> tag on the version
will not require version increases while you are developing the plugin.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s run this Plugin and see what happens</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python complex_beer_statistics_plugin.py</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex-beer-statistics-test.png" alt="Complex Beer Statistics Results">
</div>
</div>
<div class="paragraph">
<p>We can see that a child request is spawned when invoking this command. If you click on the hyperlink
for <code>download_year_statistics</code> you can see the input/output for that command.</p>
</div>
</div>
<div class="sect2">
<h3 id="building-dynamic-dropdown-list"><a class="anchor" href="#building-dynamic-dropdown-list"></a>Building Dynamic Dropdown List</h3>
<div class="paragraph">
<p>In this snippet we want to use the <code>valid_year_range</code> command output at the input to the choices list that will be
used to render the form. This is helpful when variables are environment specific or static lists.</p>
</div>
<div class="listingblock">
<div class="title">complex_beer_statistics_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">parameter</span>, <span class="include">command</span>, <span class="include">system</span>, <span class="include">SystemClient</span>, <span class="include">Plugin</span>
<span class="keyword">import</span> <span class="include">json</span>

<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">ComplexBeerStatisticsClient</span>:

    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="predefined-constant">self</span>, params):
        <span class="predefined-constant">self</span>.beer_statistics_client = SystemClient(system_name=<span class="string"><span class="delimiter">&quot;</span><span class="content">BeerStatistics</span><span class="delimiter">&quot;</span></span>, **params)

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client</span>(<span class="predefined-constant">self</span>):
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=<span class="integer">2010</span>)
        <span class="keyword">return</span> results.output

    <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="decorator">@command</span>()
    <span class="keyword">def</span> <span class="function">valid_year_range</span>(<span class="predefined-constant">self</span>):
        <span class="keyword">return</span> <span class="predefined">list</span>(<span class="predefined">range</span>(<span class="integer">2008</span>, <span class="integer">2019</span>))

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">Integer</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the year to pull Beer Production Statistics</span><span class="delimiter">&quot;</span></span>,
        choices={<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">command</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">valid_year_range</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">display</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">select</span><span class="delimiter">&quot;</span></span>},  <i class="conum" data-value="2"></i><b>(2)</b>
    )
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client_with_year</span>(<span class="predefined-constant">self</span>, year):
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=year)
        <span class="keyword">return</span> results.output

<span class="keyword">def</span> <span class="function">main</span>():

    connection_params = {<span class="string"><span class="delimiter">&quot;</span><span class="content">bg_host</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">bg_port</span><span class="delimiter">&quot;</span></span>:&lt;PORT&gt;,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">ssl_enabled</span><span class="delimiter">&quot;</span></span>:<span class="predefined-constant">False</span>}

    client = ComplexBeerStatisticsClient(connection_params)

    plugin = Plugin(
        client,
        name=<span class="string"><span class="delimiter">'</span><span class="content">ComplexBeerStatistics</span><span class="delimiter">'</span></span>,
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0.dev</span><span class="delimiter">'</span></span>,
        description=<span class="string"><span class="delimiter">'</span><span class="content">Parses data from TTB.gov on Brewer Production sizes of Beer</span><span class="delimiter">'</span></span>,
        **connection_params
    )

    plugin.run()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
    main()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We created the <code>valid_year_range</code> command that returns back the values we want to use on our form.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here we tell the <code>Parameter</code> field that it needs to use a <code>Command</code> of name <code>valid_year_range</code> to
limit the choices. By setting the <code>display</code> property to <code>select</code>, it will display the field as a drop down.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So now lets run this Plugin and see what happens</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python complex_beer_statistics_plugin.py</pre>
</div>
</div>
<div class="paragraph">
<p>When the Form is loaded it doesn&#8217;t have the Choices list,
once the command is executed the options are populated and limit input to the output of <code>valid_year_range</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex-beer-statistics-years.png" alt="Complex Beer Statistics Years">
</div>
</div>
<div class="paragraph">
<p>We can then go to the <code>Requests</code> page and see that the request was submitted to invoke that command
to populate the form.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex-beer-statistics-years-request.png" alt="Complex Beer Statistics Years Request">
</div>
</div>
</div>
<div class="sect2">
<h3 id="building-dynamic-dropdown-list-off-plugin-results"><a class="anchor" href="#building-dynamic-dropdown-list-off-plugin-results"></a>Building Dynamic Dropdown List off Plugin Results</h3>
<div class="paragraph">
<p>In this update to the snippet we are going to use the <code>Choices</code> field to specify another command for
the choices list. This is helpful when variables are managed remotely.</p>
</div>
<div class="listingblock">
<div class="title">complex_beer_statistics_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">parameter</span>, <span class="include">command</span>, <span class="include">system</span>, <span class="include">SystemClient</span>, <span class="include">Plugin</span>
<span class="keyword">import</span> <span class="include">json</span>

<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">ComplexBeerStatisticsClient</span>:

    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="predefined-constant">self</span>, params):
        <span class="predefined-constant">self</span>.beer_statistics_client = SystemClient(system_name=<span class="string"><span class="delimiter">&quot;</span><span class="content">BeerStatistics</span><span class="delimiter">&quot;</span></span>, **params)


    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client</span>(<span class="predefined-constant">self</span>):
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=<span class="integer">2010</span>)
        <span class="keyword">return</span> results.output

    <span class="decorator">@command</span>()
    <span class="keyword">def</span> <span class="function">valid_date_ranges</span>(<span class="predefined-constant">self</span>):
        <span class="keyword">return</span> <span class="predefined">list</span>(<span class="predefined">range</span>(<span class="integer">2008</span>, <span class="integer">2019</span>))

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">Integer</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the year to pull Beer Production Statistics</span><span class="delimiter">&quot;</span></span>,
        choices={<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">command</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">valid_date_ranges</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">display</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">select</span><span class="delimiter">&quot;</span></span>},
    )
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client_with_year</span>(<span class="predefined-constant">self</span>, year):
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=year)
        <span class="keyword">return</span> results.output

    <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="decorator">@command</span>()
    <span class="keyword">def</span> <span class="function">valid_summary_fields</span>(<span class="predefined-constant">self</span>):
        <span class="comment"># Grabbing a random Statistic</span>
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=<span class="integer">2010</span>)

        <span class="comment"># Parsing the first record for Fields we could run Sum Totals on</span>
        <span class="keyword">if</span> results.output:
            output = json.loads(results.output)
            fields = <span class="predefined">list</span>()
            <span class="keyword">for</span> key <span class="keyword">in</span> output[<span class="integer">0</span>]:
                <span class="keyword">if</span> <span class="predefined">isinstance</span>(output[<span class="integer">0</span>][key], (<span class="predefined">float</span>, <span class="predefined">int</span>)):
                    fields.append(key)

            <span class="keyword">return</span> fields

        <span class="keyword">return</span> []

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">STRING</span><span class="delimiter">&quot;</span></span>)
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the field to pull Beer Production Statistics on</span><span class="delimiter">&quot;</span></span>,
        choices={<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">command</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">valid_summary_fields</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">display</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">select</span><span class="delimiter">&quot;</span></span>}, <i class="conum" data-value="2"></i><b>(2)</b>
    )
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client_fields</span>(<span class="predefined-constant">self</span>, field):
        <span class="keyword">return</span> field

<span class="keyword">def</span> <span class="function">main</span>():

    connection_params = {<span class="string"><span class="delimiter">&quot;</span><span class="content">bg_host</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">bg_port</span><span class="delimiter">&quot;</span></span>:&lt;PORT&gt;,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">ssl_enabled</span><span class="delimiter">&quot;</span></span>:<span class="predefined-constant">False</span>}

    client = ComplexBeerStatisticsClient(connection_params)

    plugin = Plugin(
        client,
        name=<span class="string"><span class="delimiter">'</span><span class="content">ComplexBeerStatistics</span><span class="delimiter">'</span></span>,
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0.dev</span><span class="delimiter">'</span></span>,
        description=<span class="string"><span class="delimiter">'</span><span class="content">Parses data from TTB.gov on Brewer Production sizes of Beer</span><span class="delimiter">'</span></span>,
        **connection_params
    )

    plugin.run()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
    main()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We are going to call the <code>SystemClient</code> for Beer Statistics and pull back a single record, then find all
of the fields we can run a Sum Total Summary on.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We will set the <code>Command</code> as the choices like we did in the previous example.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now lets run this plugin and see what happens</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python complex_beer_statistics_plugin.py</pre>
</div>
</div>
<div class="paragraph">
<p>Just like before, this kicked off a <code>Command</code> in the background to pull back the valid list of fields
to be entered into the <code>Request</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex-beer-statistics-fields.png" alt="Complex Beer Statistics Fields">
</div>
</div>
</div>
<div class="sect2">
<h3 id="building-sum-total-function"><a class="anchor" href="#building-sum-total-function"></a>Building Sum Total Function</h3>
<div class="paragraph">
<p>Now we want to combine the three techniques we just learned into a single function that can determine the
sum total across all rows in the spread sheet.</p>
</div>
<div class="listingblock">
<div class="title">complex_beer_statistics_plugin.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">brewtils</span> <span class="keyword">import</span> <span class="include">parameter</span>, <span class="include">command</span>, <span class="include">system</span>, <span class="include">SystemClient</span>, <span class="include">Plugin</span>
<span class="keyword">import</span> <span class="include">json</span>

<span class="decorator">@system</span>
<span class="keyword">class</span> <span class="class">ComplexBeerStatisticsClient</span>:

    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="predefined-constant">self</span>, params):
        <span class="predefined-constant">self</span>.beer_statistics_client = SystemClient(system_name=<span class="string"><span class="delimiter">&quot;</span><span class="content">BeerStatistics</span><span class="delimiter">&quot;</span></span>, **params)

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client</span>(<span class="predefined-constant">self</span>):
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=<span class="integer">2010</span>)
        <span class="keyword">return</span> results.output

    <span class="decorator">@command</span>()
    <span class="keyword">def</span> <span class="function">valid_date_ranges</span>(<span class="predefined-constant">self</span>):
        <span class="keyword">return</span> <span class="predefined">list</span>(<span class="predefined">range</span>(<span class="integer">2008</span>, <span class="integer">2019</span>))

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">JSON</span><span class="delimiter">&quot;</span></span>)
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">Integer</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the year to pull Beer Production Statistics</span><span class="delimiter">&quot;</span></span>,
        choices={<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">command</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">valid_date_ranges</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">display</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">select</span><span class="delimiter">&quot;</span></span>},
    )
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client_with_year</span>(<span class="predefined-constant">self</span>, year):
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=year)
        <span class="keyword">return</span> results.output

    <span class="decorator">@command</span>()
    <span class="keyword">def</span> <span class="function">valid_summary_fields</span>(<span class="predefined-constant">self</span>):
        <span class="comment"># Grabbing a random Statistic</span>
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=<span class="integer">2010</span>)

        <span class="comment"># Parsing the first record for Fields we could run Sum Totals on</span>
        <span class="keyword">if</span> results.output:
            output = json.loads(results.output)
            fields = <span class="predefined">list</span>()
            <span class="keyword">for</span> key <span class="keyword">in</span> output[<span class="integer">0</span>]:
                <span class="keyword">if</span> <span class="predefined">isinstance</span>(output[<span class="integer">0</span>][key], (<span class="predefined">float</span>, <span class="predefined">int</span>)):
                    fields.append(key)

            <span class="keyword">return</span> fields

        <span class="keyword">return</span> []

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">STRING</span><span class="delimiter">&quot;</span></span>)
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the field to pull Beer Production Statistics on</span><span class="delimiter">&quot;</span></span>,
        choices={<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">command</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">valid_summary_fields</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">display</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">select</span><span class="delimiter">&quot;</span></span>},
    )
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client_fields</span>(<span class="predefined-constant">self</span>, field):
        <span class="keyword">return</span> field

    <span class="decorator">@command</span>(output_type=<span class="string"><span class="delimiter">&quot;</span><span class="content">STRING</span><span class="delimiter">&quot;</span></span>)
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">String</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the field to pull Beer Production Statistics on</span><span class="delimiter">&quot;</span></span>,
        choices={<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">command</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">valid_summary_fields</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">display</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">select</span><span class="delimiter">&quot;</span></span>},
    )
    <span class="decorator">@parameter</span>(
        key=<span class="string"><span class="delimiter">&quot;</span><span class="content">year</span><span class="delimiter">&quot;</span></span>,
        type=<span class="string"><span class="delimiter">&quot;</span><span class="content">Integer</span><span class="delimiter">&quot;</span></span>,
        description=<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the year to pull Beer Production Statistics</span><span class="delimiter">&quot;</span></span>,
        choices={<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">command</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">valid_date_ranges</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">display</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">select</span><span class="delimiter">&quot;</span></span>},
    )
    <span class="keyword">def</span> <span class="function">test_beer_statistics_client_sum_total</span>(<span class="predefined-constant">self</span>, field, year):
        results = <span class="predefined-constant">self</span>.beer_statistics_client.download_year_statistics(year=year)

        <span class="comment"># Parsing the first record for Fields we could run Sum Totals on</span>
        <span class="keyword">if</span> results.output:
            total = <span class="integer">0</span>
            output = json.loads(results.output)
            <span class="keyword">for</span> stat <span class="keyword">in</span> output:
                total += stat[field]
            <span class="keyword">return</span> <span class="predefined">round</span>(total, <span class="integer">2</span>)

        <span class="keyword">return</span> <span class="predefined-constant">None</span>


<span class="keyword">def</span> <span class="function">main</span>():

    connection_params = {<span class="string"><span class="delimiter">&quot;</span><span class="content">bg_host</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HOST&gt;</span><span class="delimiter">&quot;</span></span>,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">bg_port</span><span class="delimiter">&quot;</span></span>:&lt;PORT&gt;,
                         <span class="string"><span class="delimiter">&quot;</span><span class="content">ssl_enabled</span><span class="delimiter">&quot;</span></span>:<span class="predefined-constant">False</span>}

    client = ComplexBeerStatisticsClient(connection_params)

    plugin = Plugin(
        client,
        name=<span class="string"><span class="delimiter">'</span><span class="content">ComplexBeerStatistics</span><span class="delimiter">'</span></span>,
        version=<span class="string"><span class="delimiter">'</span><span class="content">1.0.0.dev</span><span class="delimiter">'</span></span>,
        description=<span class="string"><span class="delimiter">'</span><span class="content">Parses data from TTB.gov on Brewer Production sizes of Beer</span><span class="delimiter">'</span></span>,
        **connection_params
    )

    plugin.run()

<span class="keyword">if</span> __name__ == <span class="string"><span class="delimiter">&quot;</span><span class="content">__main__</span><span class="delimiter">&quot;</span></span>:
    main()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now lets run this plugin and see what happens</p>
</div>
<div class="literalblock">
<div class="content">
<pre>python complex_beer_statistics_plugin.py</pre>
</div>
</div>
<div class="paragraph">
<p>The form for the request has two dynamic fields that are required to be populated with valid input
for the command to execute. Try inputting something incorrect here and see what happens.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex-beer-statistics-final-request.png" alt="Complex Beer Statistics Fields">
</div>
</div>
<div class="paragraph">
<p>After we execute the request we can see that it spawned a child request and only returned the
Sum Total of the field. If you want to verify this, you can go into the child request and count the values.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/complex-beer-statistics-final-response.png" alt="Complex Beer Statistics Fields">
</div>
</div>
</div>
<div class="sect2">
<h3 id="conclusion-4"><a class="anchor" href="#conclusion-4"></a>Conclusion</h3>
<div class="paragraph">
<p>This has been a basic example of how you can use Beer Garden to dynamically generate forms and invoke other plugins
for results. Similar to our example, we recommend you start by creating your own plugins that accomplish  single
objectives. Then add more complex logic and orchestration on top of those basic function plugins. This will make it
easier to debug your code from the UI and manage incremental releases of your plugins.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="now-what"><a class="anchor" href="#now-what"></a>Now What?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you know the basics for creating Beer Garden plugins, it is time to experiment.  Go out and create your own
plugins. Maybe there is a script you run daily for your job and you want to automate it, use Beer Garden. Maybe there
is an analytic that you run monthly to generate a report, use Beer Garden. We will be here to support the community
and provide guidance.</p>
</div>
<div class="paragraph">
<p>If you want to go the extra mile, have you considered becoming an open source developer yourself?
Beer Garden and many other projects out there need your support and time. Donate your time to
improve something that you have a passion in.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-11-16 15:59:35 UTC
</div>
</div>
</body>
</html>